import{openBlock as t,createElementBlock as e,normalizeStyle as s,createElementVNode as i,Fragment as l,renderList as o,normalizeClass as a,withModifiers as n}from"vue";var d={emits:["update:modelValue"],props:{id:{type:String,default:Math.random().toString(36).substr(2,9)},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},options:{type:Array,default:()=>[]},placeholder:{type:String,default:null},value:{type:String,default:"value"},text:{type:String,default:"text"}},data:()=>({filteredList:[],query:null,childSelected:null,formList:null,formListMenu:null,listWidth:0,isOpen:!1}),watch:{query(){this.filteredList=this.matchQuery(this.options),this.formList.classList.toggle("show",this.filteredList.length),this.formListMenu.classList.toggle("show",this.filteredList.length)}},updated(){if(this.isOpen){const t=this.formListMenu.querySelector(".form-datalist-item--selected");if(t){const e=t.parentElement,s=e.clientHeight;e.scroll(0,t.offsetTop-s/2)}}},mounted(){this.formList=this.$refs["form-list"],this.formListMenu=this.$refs["form-list-menu"],this.$attrs.modelValue&&(this.childSelected=this.options.find((t=>t[this.value]==this.$attrs.modelValue))?.[this.text]),this.listWidth=`${this.formList.querySelector("input").clientWidth}px`,document.body.addEventListener("click",(({target:t})=>{t&&!this.classStartsWith(t.classList,"form-datalist")&&(this.formList.classList.remove("show"),this.formListMenu.classList.remove("show"),this.isOpen=!1)}))},methods:{matchQuery(t){return t.filter((t=>String(t[this.text]).toLowerCase().includes(String(this.query).toLowerCase())))},classStartsWith:(t,e)=>Array.from(t).find((t=>t.startsWith(e))),toggleDropdown(){this.formList.classList.toggle("show"),this.formListMenu.classList.toggle("show"),this.isOpen=this.formListMenu.classList.contains("show"),this.isOpen&&(this.filteredList=this.options)},handleSelected(t){this.$emit("update:modelValue",t[this.value]),this.childSelected=t[this.text],this.toggleDropdown(),this.query=null},handleInput({target:t}){this.query=t.value,this.childSelected=t.value},handleChange({target:t}){this.query=t.value;const e=this.options.find((e=>e[this.text]==t.value));e?(this.$emit("update:modelValue",e[this.value]),this.childSelected=t.value):(this.$emit("update:modelValue",null),this.childSelected=null)},handleFocus(){this.isOpen=!0},handleBlur(){this.isOpen=!1},formatText(t){if(!t)return t;const e=new RegExp(this.childSelected,"gi");return t.replace(e,"<strong>$&</strong>")}}};const r={class:"form-datalist__search"},h=["id","placeholder","value","required","disabled"],u=["disabled"],c={class:"form-datalist__list dropdown-menu",ref:"form-list-menu"},f=["title","onClick","innerHTML"];d.render=function(d,m,p,g,L,v){return t(),e("div",{class:"form-datalist dropdown",ref:"form-list",style:s({"--list-max-width":L.listWidth})},[i("div",r,[i("input",{id:p.id,class:"form-control",type:"seach",placeholder:p.placeholder,value:L.childSelected,onInput:m[0]||(m[0]=(...t)=>v.handleInput&&v.handleInput(...t)),onChange:m[1]||(m[1]=(...t)=>v.handleChange&&v.handleChange(...t)),onFocus:m[2]||(m[2]=(...t)=>v.handleFocus&&v.handleFocus(...t)),onBlur:m[3]||(m[3]=(...t)=>v.handleBlur&&v.handleBlur(...t)),autocomplete:"off",required:p.required,disabled:p.disabled},null,40,h),i("button",{class:"form-datalist__button btn dropdown-toggle",type:"button",onClick:m[4]||(m[4]=(...t)=>v.toggleDropdown&&v.toggleDropdown(...t)),disabled:p.disabled||!p.options.length},null,8,u)]),i("div",c,[(t(!0),e(l,null,o(L.filteredList,(s=>(t(),e("a",{href:"#",key:s[p.value],title:s[p.text],class:a(["dropdown-item",{"form-datalist-item--selected":d.$attrs.modelValue===s[p.value]}]),onClick:n((t=>v.handleSelected(s)),["prevent"]),innerHTML:v.formatText(s[p.text])},null,10,f)))),128))],512)],4)},d.__scopeId="data-v-7e2724cd",d.__file="src/VBDataList.vue",d.install=function(t){t.component(d.name,d)};export{d as default};

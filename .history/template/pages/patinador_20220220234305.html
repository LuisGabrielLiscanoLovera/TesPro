{% load static %}


<div id="openModalPatinador" class="modalDialogPadre">
  <div> <a href="#close" title="Close" class="close"><i class="btn-outline-danger btn-outline-danger icofont-ui-close"></i></a>

    <center>
<u>
  <h1>Patinadores de {% for i in nomEmpresaU %}{{ i|title }}{% endfor %}</h1>

</u><hr>
    </center> 
    



    <div class="row">
      <div class="col-sm-3">
        
        <h6 style="text-align: center;">Agregar patinador</h6> <hr>
        <form id="addPatinador" autocomplete="off" class=" ">
          <div class="" >
            <div>             
                <input type="text" list="BuscarIntegrantes"  name="idIntegrante"  required Placeholder="Integrante..." class="form-control" style="width:150px;">
                        <datalist id="BuscarIntegrantes">
                          {% for results in allIntegrante %}
                                  <option  value="{{results.id}}">{{results.nombres}} {{results.apellidos}}</option>
                          {% endfor %}
                        </datalist>
    
                        <input type="password" name="passwordP"   Placeholder="clave patinador" class="form-control" style="width:150px;">
                        
                        
                        
                        <input type="number" hidden="True" name="idEmpresa" value="{{ lastIdEmpresa }}">
                        <input type="number" hidden="True" name="idUser" value="{{ login_user_id}}">  
                        <button class="btn btn-outline-primary btn-" type="submit" onclick="location.href='/'">Agregar patinador</button>
                      
              
                        
         
                
             
            </div>
          </div>
           
       </form>
    
    
    
    
      </div>




    <!--

data-show-refresh="true"
data-auto-refresh="true"
data-auto-refresh-interval="30"
data-auto-refresh-silent="true"
data-auto-refresh-status="true"
-->
<div class="col-sm-9"> 
<table
id="patinadorTable"
data-id-field="id"
class="table"
data-toggle="table"
data-detail-view="true"
data-detail-view-by-click="true"
data-show-columns="true"
data-search="True"
data-show-fullscreen="true"        
data-locale="es-SP"
data-pagination="true"
data-detail-view-icon="false"

data-url="patinador/patinador-list/">

<thead class="thead-dark">
  <tr>
<!--     <th data-field="datosPatinador" class="text-center">datosPatinador</th>
 -->    <th data-field="nomPatinador" class="text-center">Nombre </th>
 <th data-field="apellPatinador" class="text-center">Apellido </th>
    <th data-field="estatus" class="text-center">Estatus</th>
    <th data-field="created_at" class="text-center">Fecha </th>   
    <th data-field="btnAcci" data-detail-formatter="DetailFormatterButAccionPatinador"class="text-center">Accion</th>
  </tr>
</thead>

</table>
</div>

</div>





<!--table patinador-->
<script>

$('#patinadorTable').SetEditable();


function DetailFormatterButAccionPatinador(index,row){
  return '<form id="editarIpatinador" style="display: inline"  >{% csrf_token %}<hr>'+
        '<div class="row">'+
        
     
        
        '<div class="col-sm-3">'+
            
            '<div class="form-group"><label>Estatus</label>'+
            '<select class="form-group" id="estatusUP">'+
                '<option value="'+row.estatus+'">'+row.estatus+'</option>'+
                '<option value="A">Activo</option>'+
                '<option value="I">Inactivo</option>'+
            '</select></div>'+
            '<input type="number" hidden="True" name="idEmpresaUP" value="{{ lastIdEmpresa }}">'+
            '<input type="number" hidden="True" name="idUserUP" value="{{ login_user_id}}">'+
            '<input type="number" hidden="True" name="idIpatinadorUP" value="'+row.id+'"'+           
            
            '</div>'+
          '<input id="EditPatinadorBtn-'+row.id+'" value="Actualizar registro" type="submit" onclick="editPatinador('+row.id+')" class="btn-md  btn btn-outline-warning btn-rounded  " >'+ 
      
        
       
        

        '</div>'+
        '<div class="col-sm-1">'+'<button value="" onclick="remove('+row.id+')"  id="buttonEliminarPatinador" class="btn btn-outline-danger icofont-ui-remov ">Eliminar</button>'+
        '</div>'+
        '</form>';
        
        
        
}




</script>

</div>  
</div>




 <!--create ipatinador-->
<script>
  $("form#addPatinador").submit(function() { 


var idIntegrante       = $('input[name="idIntegrante"]').val().trim();
var idEmpresa         
= $('input[name="idEmpresa"]').val().trim();
var idUser            = $('input[name="idUser"]').val().trim();
if (idIntegrante &&  idEmpresa && idUser 
    ) {
    // Create Ajax Call
    $.ajax({
        url: '{% url "Patinador_ajax_create" %}',
        data: {
            
            'idIntegrante'     : idIntegrante,
         
            'idEmpresa'         : idEmpresa,
            'idUser'            : idUser
            


            
        },
        dataType: 'json',
        success: function (data) {
            if (data.user) {
              appendToUsrTable(data.user);
            }
        }
    });

} else {
    alert("All fields must have a valid value.");
}
$('form#addPatinador').trigger("reset");
return false;
});


</script>
<!--editar ipatinador-->
<script>
function editPatinador  (id){

  

var estatusUP           = document.getElementById("estatusUP").value;
var idEmpresaUP         = $('input[name="idEmpresaUP"]').val().trim();
var idUserUP            = $('input[name="idUserUP"]').val().trim();



if ( estatusUP && idEmpresaUP && idUserUP  
    ) {

    // Create Ajax Call
    $.ajax({
        url: '{% url "Patinador_ajax_update" %}',
        data: {
            'estatusUP'         : estatusUP,
            'idEmpresaUP'       : idEmpresaUP,
            'idUserUP'          : idUserUP,
            'idIpatinadorUP'    : id


            
        },
        dataType: 'json',
        success: function (data) {
            if (data.user) {
              appendToUsrTable(data.user);
            }
        }
    });

} else {
    alert("All fields must have a valid value.");
}
}
</script>
<!--Delete patinador-->
<script>
 function remove (idPatinador) {


  $.ajax({
            url: '{% url "Patinador_ajax_delete" %}',
            data: {
                'id': idPatinador,
            },
            dataType: 'json',
            success: function (data) {
           
              window.location.reload();


              
            }
            });
}




</script>

